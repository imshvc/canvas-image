var CanvasImage={version:"20250406",count:0,contextAttributes:{alpha:!1,colorSpace:"srgb",desynchronized:!1,willReadFrequently:!0},create:function(t=1,a=1){t|=0,a|=0;let e=Object.setPrototypeOf({},CanvasImage);return e.id=CanvasImage.count++,e.width=t,e.height=a,e.context=null,e.image=null,e.created=+Date.now(),e.updated=0,e.path=null,e.ready=!0,e.locked=!1,e.dirty=!1,e.error=null,e.container=null,e.spawned=!1,0>=t||t>8192?(e.error="bad width",e):0>=a||a>8192?(e.error="bad height",e):(e.canvas=document.createElement("canvas"),e.canvas.width=t,e.canvas.height=a,e.canvas.CanvasImage=e,e.context=e.canvas.getContext("2d",CanvasImage.contextAttributes),null===e.context?(e.error="failed to create context",e):(e.image=new ImageData(t,a),e.image.data.fill(255),e.sync(),e))},load:function(t=null,a=null){if(null===t)return null;"function"!=typeof a&&(a=function(){});let e=CanvasImage.create().lock();e.ready=!1,e.path=t;let i=new Image;return i.crossOrigin="anonymous",i.addEventListener("load",(function(){let t=i.width,n=i.height;e.ready=!0,e.canvas.width=t,e.canvas.height=n,e.width=t,e.height=n,e.context.drawImage(i,0,0,t,n);try{e.image=e.context.getImageData(0,0,t,n)}catch(t){return e.ready=!1,e.error=t.message,a(e),e}e.unlock(),a(e)}),!1),i.addEventListener("error",(function(){e.error="failed to load image",a(e)}),!1),i.src=t,e},sync:function(){return this.context.putImageData(this.image,0,0),this.dirty=!1,this.updated=+Date.now(),this},setColor:function(t,a,e,i,n){if(this.locked)return this;t|=0,a|=0;let r=this.width*a*4+4*t;return this.image.data[r+0]=e,this.image.data[r+1]=i,this.image.data[r+2]=n,this.dirty=!0,this},getColor:function(t,a){t|=0,a|=0;let e=this.width*a*4+4*t;return[this.image.data[e+0],this.image.data[e+1],this.image.data[e+2]]},setAlpha:function(t,a,e){if(this.locked)return this;t|=0,a|=0;let i=this.width*a*4+4*t;return this.image.data[i+3]=e,this.dirty=!0,this},getAlpha:function(t,a){t|=0,a|=0;let e=this.width*a*4+4*t;return this.image.data[e+3]},spawn:function(t=null){return this.error?this:null===t||t instanceof Element==!1?(this.error="container is not an element",this):null!==this.container?(this.error="resource already spawned",this):(t.append(this.canvas),this.container=t,this.spawned=!0,this)},despawn:function(){if(null===this.container)return this;let t=this.canvas.parentElement;return null===t||(t.removeChild(this.canvas),this.container=null,this.spawned=!1),this},clear:function(t=0,a=0,e=0){if(this.locked)return this;for(let i=0;i<this.image.data.length;i+=4)this.image.data[i+0]=t,this.image.data[i+1]=a,this.image.data[i+2]=e;return this},save:function(t="0.png"){let a=document.createElement("a");return a.href=this.canvas.toDataURL(),a.download=t,a.click(),this},lock:function(){return this.locked=!0,this},unlock:function(){return this.locked=!1,this},clone:function(){let t=CanvasImage.create(this.width,this.height);for(let a=0;a<this.image.data.length;a+=4)t.image.data[a+0]=this.image.data[a+0],t.image.data[a+1]=this.image.data[a+1],t.image.data[a+2]=this.image.data[a+2],t.image.data[a+3]=this.image.data[a+3];return t.sync(),t},getChannel:function(t=0){0>(t|=0)&&(t=0),t>3&&(t=3);let a=CanvasImage.create(this.width,this.height);for(let e=0;e<a.image.data.length;e+=4)a.image.data[e+0]=this.image.data[e+t],a.image.data[e+1]=this.image.data[e+t],a.image.data[e+2]=this.image.data[e+t];return a.sync(),a}};